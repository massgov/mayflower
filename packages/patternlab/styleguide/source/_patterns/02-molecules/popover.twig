{#
 # The popover component requires what may appear to be some strange decisions.
 # For example, the use of <span> tags with roles instead of <dialog> or <h2>.
 #
 # This is required to allow popovers to work within page content. <p> tags only
 # support phrasing (text) content. The more semantically obvious alternatives
 # therefore break containing paragraphs into multiple separate paragraphs.
 # @see: https://developer.mozilla.org/en-US/docs/Web/HTML/Guides/Content_categories#phrasing_content
 #
 # Additionally, we add tabindex="-1" to the dialog element to catch focus if
 # users interact with the popover content, preventing it from closing on 'focusout'
 #
 # To prevent extra spaces from appearing around the popover, also need to collapse all whitespace, hence the set-blocks.
 #}

{% set trigger %}<button type="button" class="popover__trigger js-popover-trigger">{{tooltip.openText}}</button>{% endset %}

{% set dialog_opentag %}<span role="dialog" id="popover-{{ tooltip.controlId }}" aria-labelledby="popover-{{ tooltip.controlId }}-label" aria-modal="true" class="popover__dialog js-popover-dialog" tabindex="-1">{% endset %}
{% set dialog_caret %}<span class="popover__caret js-popover-caret"></span>{% endset %}
{% set dialog_close %}<button type="button" class="popover__close js-popover-close" aria-label="{{ tooltip.closeText }}">{{icon('close')}}</button>{% endset %}
{% set dialog_title %}<span role="heading" aria-level="{{ headingLevel ?: 2 }}" class="popover__title" id="popover-{{ tooltip.controlId }}-label">{{ tooltip.title }}</span>{% endset %}
{% set dialog_body %}<span class="popover__body">{{ tooltip.message }}</span>{% endset %}
{% set dialog_closetag %}</span>{% endset %}

{% set dialog %}{{ dialog_opentag }}{{ dialog_caret }}{{ dialog_close }}{{ dialog_title }}{{ dialog_body }}{{ dialog_closetag }}{% endset %}
<span class="popover">{{trigger}}{{dialog}}</span>
